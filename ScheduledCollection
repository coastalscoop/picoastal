#/bin/bash
# This is the main capture script controler

sitename="BlastBeach"
harddrive="/media/odroid/3832-3239"
# create log dir
mkdir -p "/home/odroid/multicam/logs/"

# Export this variable
export FLIR_GENTL32_CTI=/opt/spinnaker/lib/flir-gentl/FLIR_GenTL.cti

# Define where your code is located
workdir="/home/odroid/multicam/"
echo "Current work dir is : "$workdir

# Get the current date
date=$(date)
datestr=$(date +'%Y%m%d_%H%M')
echo "Current date is : "$date

# Your configuration file
cfg="/home/odroid/multicam/config_flir.json"
echo "Capture config file is : "$cfg

# Change to current work directory
cd $workdir

# Current cycle log file
log="/home/odroid/multicam/logs/multicam_"$datestr".log"
echo "Log file is : "$log

# Call the capture script
capdate=$(date +'%Y%m%d_%H00')
echo $capdate
script=capture2.py
echo "Calling script : "$script
python3 $workdir/src/flir/$script -cfg $cfg -o "data/$sitename/$capdate/" > $log 2>&1
echo $(<$log)


